<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegraph Finder - åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 20px;
            background: #f5f5f7;
        }
        
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e5e5e7;
            border-radius: 8px;
        }
        
        .test-button {
            background: #007aff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
        }
        
        .test-button:hover {
            background: #0056b3;
        }
        
        .log-area {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .file-item-test {
            width: 100px;
            height: 100px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 8px;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 10px;
            cursor: pointer;
        }
        
        .file-item-test:hover {
            background: #e0e0e0;
        }
        
        .context-menu-test {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            z-index: 1000;
        }
        
        .menu-item-test {
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .menu-item-test:hover {
            background: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Telegraph Finder åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h3>1. åŸºç¡€åŠŸèƒ½æµ‹è¯•</h3>
            <button class="test-button" onclick="testNewFolder()">æµ‹è¯•æ–°å»ºæ–‡ä»¶å¤¹</button>
            <button class="test-button" onclick="testLocalStorage()">æµ‹è¯•æœ¬åœ°å­˜å‚¨</button>
            <button class="test-button" onclick="clearLogs()">æ¸…é™¤æ—¥å¿—</button>
        </div>
        
        <div class="test-section">
            <h3>2. å³é”®èœå•æµ‹è¯•</h3>
            <p>å³é”®ç‚¹å‡»ä¸‹é¢çš„æ–‡ä»¶é¡¹æµ‹è¯•å³é”®èœå•ï¼š</p>
            <div class="file-item-test" data-file-id="test-file-1">
                <div>ğŸ“„</div>
                <div>æµ‹è¯•æ–‡ä»¶1</div>
            </div>
            <div class="file-item-test" data-file-id="test-file-2">
                <div>ğŸ–¼ï¸</div>
                <div>æµ‹è¯•å›¾ç‰‡</div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>3. è°ƒè¯•æ—¥å¿—</h3>
            <div id="logArea" class="log-area">ç­‰å¾…æµ‹è¯•...\n</div>
        </div>
    </div>
    
    <!-- æµ‹è¯•å³é”®èœå• -->
    <div id="testContextMenu" class="context-menu-test">
        <div class="menu-item-test" data-action="open">æ‰“å¼€</div>
        <div class="menu-item-test" data-action="copy">å¤åˆ¶é“¾æ¥</div>
        <div class="menu-item-test" data-action="delete">åˆ é™¤</div>
    </div>

    <script>
        let testFileId = null;
        
        // åŠ«æŒconsole.logæ¥æ˜¾ç¤ºæ—¥å¿—
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const logArea = document.getElementById('logArea');
            if (logArea) {
                logArea.textContent += args.join(' ') + '\n';
                logArea.scrollTop = logArea.scrollHeight;
            }
        };
        
        // æµ‹è¯•æ–°å»ºæ–‡ä»¶å¤¹
        function testNewFolder() {
            console.log('ğŸ§ª å¼€å§‹æµ‹è¯•æ–°å»ºæ–‡ä»¶å¤¹åŠŸèƒ½');
            
            const folderName = prompt('è¯·è¾“å…¥æµ‹è¯•æ–‡ä»¶å¤¹åç§°:');
            if (folderName) {
                console.log('âœ… ç”¨æˆ·è¾“å…¥æ–‡ä»¶å¤¹åç§°:', folderName);
                
                // æ¨¡æ‹Ÿæ–‡ä»¶å¤¹åˆ›å»ºé€»è¾‘
                const folderId = 'test_folder_' + Date.now();
                const folderData = {
                    id: folderId,
                    name: folderName,
                    isFolder: true,
                    createdAt: new Date()
                };
                
                // ä¿å­˜åˆ°localStorage
                localStorage.setItem('test_folder_' + folderId, JSON.stringify(folderData));
                console.log('âœ… æ–‡ä»¶å¤¹æ•°æ®å·²ä¿å­˜åˆ°localStorage');
                console.log('ğŸ“ æ–‡ä»¶å¤¹ä¿¡æ¯:', folderData);
            } else {
                console.log('âŒ ç”¨æˆ·å–æ¶ˆæˆ–è¾“å…¥ä¸ºç©º');
            }
        }
        
        // æµ‹è¯•æœ¬åœ°å­˜å‚¨
        function testLocalStorage() {
            console.log('ğŸ§ª æµ‹è¯•æœ¬åœ°å­˜å‚¨åŠŸèƒ½');
            
            const testData = {
                test: true,
                timestamp: Date.now(),
                message: 'Telegraph Finder æµ‹è¯•æ•°æ®'
            };
            
            try {
                localStorage.setItem('finder_test', JSON.stringify(testData));
                const retrieved = JSON.parse(localStorage.getItem('finder_test'));
                console.log('âœ… localStorage è¯»å†™æ­£å¸¸');
                console.log('ğŸ“¦ æµ‹è¯•æ•°æ®:', retrieved);
                
                // æ˜¾ç¤ºæ‰€æœ‰finderç›¸å…³çš„å­˜å‚¨
                const finderKeys = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key && (key.includes('finder') || key.includes('folder'))) {
                        finderKeys.push(key);
                    }
                }
                console.log('ğŸ—‚ï¸ æ‰¾åˆ°çš„finderç›¸å…³å­˜å‚¨é”®:', finderKeys);
                
            } catch (error) {
                console.log('âŒ localStorage æµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        // æ¸…é™¤æ—¥å¿—
        function clearLogs() {
            document.getElementById('logArea').textContent = 'æ—¥å¿—å·²æ¸…é™¤\n';
        }
        
        // å³é”®èœå•æµ‹è¯•
        document.addEventListener('contextmenu', (e) => {
            const fileItem = e.target.closest('.file-item-test');
            if (fileItem) {
                e.preventDefault();
                console.log('ğŸ–±ï¸ å³é”®ç‚¹å‡»æµ‹è¯•æ–‡ä»¶é¡¹:', fileItem.dataset.fileId);
                
                testFileId = fileItem.dataset.fileId;
                const menu = document.getElementById('testContextMenu');
                menu.style.display = 'block';
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';
            }
        });
        
        // èœå•é¡¹ç‚¹å‡»
        document.addEventListener('click', (e) => {
            const menuItem = e.target.closest('.menu-item-test[data-action]');
            if (menuItem) {
                e.preventDefault();
                const action = menuItem.dataset.action;
                console.log('ğŸ¯ èœå•åŠ¨ä½œ:', action, 'æ–‡ä»¶ID:', testFileId);
                
                switch (action) {
                    case 'open':
                        console.log('ğŸ“‚ æ‰§è¡Œæ‰“å¼€æ“ä½œ');
                        break;
                    case 'copy':
                        console.log('ğŸ“‹ æ‰§è¡Œå¤åˆ¶é“¾æ¥æ“ä½œ');
                        break;
                    case 'delete':
                        console.log('ğŸ—‘ï¸ æ‰§è¡Œåˆ é™¤æ“ä½œ');
                        break;
                }
                
                document.getElementById('testContextMenu').style.display = 'none';
            } else {
                // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
                document.getElementById('testContextMenu').style.display = 'none';
            }
        });
        
        console.log('ğŸš€ Telegraph Finder æµ‹è¯•é¡µé¢å·²åŠ è½½');
        console.log('ğŸ’¡ è¯·ä½¿ç”¨ä¸Šé¢çš„æŒ‰é’®æµ‹è¯•å„é¡¹åŠŸèƒ½');
    </script>
</body>
</html>
